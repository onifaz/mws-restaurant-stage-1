{"version":3,"sources":["restaurant_info.js"],"names":["restaurant","map","document","addEventListener","event","fetchRestaurantFromURL","error","console","getElementById","addGmapDetail","submitReview","window","innerWidth","mapBtn","setTimeout","click","initDetailMap","self","google","maps","Map","zoom","center","latlng","scrollwheel","DBHelper","mapMarkerForRestaurant","setAttribute","script","createElement","src","type","body","appendChild","callback","id","getParameterByName","fetchRestaurantById","title","name","querySelector","fillBreadcrumb","fillRestaurantHTML","lazyload","newReview","parentNode","removeChild","innerHTML","favoriteBtn","is_favorite","setFavoriteButton","favoriteRestaurant","target","address","imageDiv","image","imageUrlForRestaurant","append","cuisine_type","operating_hours","fillRestaurantHoursHTML","fetchReviews","status","classList","add","remove","className","indexOf","fetchReviewsByRestaurantId","reviews","fillErrorReviewsHTML","fillReviewsHTML","operatingHours","hours","head","dayCol","hoursCol","key","row","day","time","container","noReviews","sort","ar1","ar2","createdAt","ul","forEach","review","createReviewHTML","li","article","div","date","Date","toDateString","rating","ratingString","i","len","comments","breadcrumb","getElementsByTagName","a","url","location","href","replace","results","RegExp","exec","decodeURIComponent","escapeRegExp","string","reviewHtml","form_button","form_name","form_comment","form_rating","form_stars","value","form_messageArea","reviewList","errorMessage","preventDefault","resetMessage","disabled","length","style","display","restaurant_id","parseInt","saveReview","then","selectedIndex","_","firstChild","insertBefore","smoothScrollTo","focus","message","easeInOutQuart","from","distance","duration","targetID","delta","startY","scrollY","pageYOffset","element","endY","offsetTop","scrollTop","clientTop","distanceY","startTime","getTime","timer","setInterval","newY","clearInterval","scrollTo"],"mappings":"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","file":"restaurant_info.js","sourcesContent":["let restaurant, map;\n\ndocument.addEventListener('DOMContentLoaded', event => {\n  /* Populate the page without waiting for google maps*/\n  fetchRestaurantFromURL((error, restaurant) => {\n    if (error) {\n      console.error(error);\n    }\n  });\n  document\n    .getElementById('show-map')\n    .addEventListener('click', addGmapDetail, true);\n  document\n    .getElementById('new-review-form')\n    .addEventListener('submit', submitReview);\n  //no need for if (el.attachEvent) {el.attachEvent('onsubmit', submitReview)} since we are also using arrow functions, so no IE11\n  if (window.innerWidth >= 992) {\n    const mapBtn = document.getElementById('show-map');\n    window.setTimeout(mapBtn.click(), 250);\n  }\n\n  // Alternative to SW Background SYNC\n  // if (navigator.onLine) {\n  //   DBHelper.syncAllData();\n  // }\n  // window.addEventListener('online', function() {\n  //   DBHelper.syncAllData();\n  // });\n  // window.addEventListener('offline', function() {\n  //   console.info('It seems we are offline at the moment...');\n  // });\n});\n\n/**\n * Initialize Google map, called from HTML.\n */\nwindow.initDetailMap = () => {\n  if (self.restaurant) {\n    self.map = new google.maps.Map(document.getElementById('map'), {\n      zoom: 16,\n      center: self.restaurant.latlng,\n      scrollwheel: false\n    });\n    //updateRestaurants();\n    if (typeof google === 'object' && typeof google.maps === 'object')\n      DBHelper.mapMarkerForRestaurant(self.restaurant, self.map);\n  }\n};\n/**\n * Add google map only on request of interactivity\n */\naddGmapDetail = () => {\n  document\n    .getElementById('map-container')\n    .setAttribute('class', 'map--requested');\n  const script = document.createElement('script');\n  script.src = `https://maps.googleapis.com/maps/api/js?key=AIzaSyBN-_N7NAK_k8QKsoHe6pd4M8aIhA1HX6E&libraries=places&callback=initDetailMap`;\n  script.type = 'text/javascript';\n  document.body.appendChild(script);\n};\n\n/**\n * Get current restaurant from page URL.\n */\nfetchRestaurantFromURL = callback => {\n  if (self.restaurant) {\n    // restaurant already fetched!\n    callback(null, self.restaurant);\n    return;\n  }\n  const id = getParameterByName('id');\n  if (!id) {\n    // no id found in URL\n    error = 'No restaurant id in URL';\n    callback(error, null);\n  } else {\n    DBHelper.fetchRestaurantById(id, (error, restaurant) => {\n      self.restaurant = restaurant;\n      if (!restaurant) {\n        console.error(error);\n        const newReview = document.getElementById('new-review');\n        newReview.parentNode.removeChild(newReview);\n        return;\n      }\n      document.title = `${restaurant.name} -  Info & Details`;\n      document\n        .querySelector('meta[name=\"description\"]')\n        .setAttribute(\n          'content',\n          `Information about ${\n            restaurant.name\n          }: location, opnening hours and latest reviews`\n        );\n      fillBreadcrumb();\n      fillRestaurantHTML();\n      lazyload();\n      callback(null, restaurant);\n    });\n  }\n};\n/**\n * Create restaurant HTML and add it to the webpage\n */\nfillRestaurantHTML = (restaurant = self.restaurant) => {\n  const name = document.getElementById('restaurant-name');\n  name.innerHTML = restaurant.name;\n\n  const favoriteBtn = document.getElementById('favorite-button');\n  if (restaurant.is_favorite == 'true') {\n    setFavoriteButton(favoriteBtn, 'true', restaurant);\n  } else {\n    favoriteBtn.setAttribute(\n      'arial-label',\n      `Add ${restaurant.name} to your favorite list.`\n    );\n  }\n  favoriteBtn.addEventListener('click', event => {\n    favoriteRestaurant(event.target, restaurant);\n  });\n\n  const address = document.getElementById('restaurant-address');\n  address.innerHTML = restaurant.address;\n  address.setAttribute('tabindex', '0');\n\n  const imageDiv = document.getElementById('restaurant-img');\n  const image = DBHelper.imageUrlForRestaurant(restaurant);\n  imageDiv.append(image);\n\n  const cuisine = document.getElementById('restaurant-cuisine');\n  cuisine.innerHTML = restaurant.cuisine_type;\n\n  // fill operating hours\n  if (restaurant.operating_hours) {\n    fillRestaurantHoursHTML();\n  }\n  // fill reviews\n  //fillReviewsHTML();\n  fetchReviews();\n};\n\n/*\n * Set status (text and class) for favorite button\n */\nsetFavoriteButton = (target, status, restaurant) => {\n  if (status === 'true') {\n    target.classList.add('is-favorite');\n    target.innerHTML = '&#9733; Favorite';\n    target.setAttribute(\n      'arial-label',\n      `${\n        restaurant.name\n      } is one of your favorite restaurants. Click to remove it from your favorites' list`\n    );\n  } else {\n    target.classList.remove('is-favorite');\n    target.innerHTML = '&#9734; Add to favorite';\n    target.setAttribute(\n      'arial-label',\n      `Add ${restaurant.name} to your favorite list.`\n    );\n  }\n};\n\n/*\n * Restaurant function add-to or remove-from favorites\n */\nfavoriteRestaurant = (target, restaurant) => {\n  if (target.className.indexOf('is-favorite') > -1) {\n    setFavoriteButton(target, 'false', restaurant);\n    DBHelper.favoriteRestaurant(restaurant, 'false');\n  } else {\n    setFavoriteButton(target, 'true', restaurant);\n    DBHelper.favoriteRestaurant(restaurant, 'true');\n  }\n};\n\n/**\n * Get current restaurant from page URL.\n */\nfetchReviews = callback => {\n  const id = getParameterByName('id');\n  if (!id) {\n    // no id found in URL\n    error = 'No restaurant id in URL';\n    callback(error, null);\n  } else {\n    DBHelper.fetchReviewsByRestaurantId(id, (error, reviews) => {\n      self.restaurant.reviews = reviews;\n      if (!reviews) {\n        console.error(error);\n        fillErrorReviewsHTML();\n        return;\n      }\n      fillReviewsHTML();\n    });\n  }\n};\n\n/**\n * Create restaurant operating hours HTML table and add it to the webpage.\n */\nfillRestaurantHoursHTML = (\n  operatingHours = self.restaurant.operating_hours\n) => {\n  const hours = document.getElementById('restaurant-hours');\n  const head = document.createElement('tr');\n  const dayCol = document.createElement('th');\n  const hoursCol = document.createElement('th');\n\n  dayCol.setAttribute('scope', 'col');\n  dayCol.setAttribute('tabindex', '0');\n  dayCol.innerHTML = 'Day';\n  head.appendChild(dayCol);\n\n  hoursCol.setAttribute('scope', 'col');\n  hoursCol.setAttribute('tabindex', '0');\n  hoursCol.innerHTML = 'Opening hours';\n  head.appendChild(hoursCol);\n\n  hours.appendChild(head);\n\n  for (let key in operatingHours) {\n    const row = document.createElement('tr');\n    const day = document.createElement('td');\n    const time = document.createElement('td');\n\n    day.innerHTML = key;\n    day.setAttribute('tabindex', '0');\n    row.appendChild(day);\n\n    time.innerHTML = operatingHours[key];\n    time.setAttribute('tabindex', '0');\n    row.appendChild(time);\n\n    hours.appendChild(row);\n  }\n};\n\n/**\n * Create all reviews HTML and add them to the webpage.\n */\nfillReviewsHTML = (reviews = self.restaurant.reviews) => {\n  const container = document.getElementById('reviews-container');\n  const title = document.createElement('h3');\n\n  title.innerHTML = 'Reviews';\n  title.setAttribute('id', 'reviews-title');\n  container.appendChild(title);\n\n  if (!reviews) {\n    const noReviews = document.createElement('p');\n    // const emptyList = document.getElementById('reviews-list');\n    // container.removeChild(emptyList);\n    noReviews.setAttribute('class', 'review--notfound');\n    noReviews.innerHTML = 'No reviews yet!';\n    container.appendChild(noReviews);\n    return;\n  }\n\n  //latest on top, \"TripAdvisor\" mode\n  function compare(ar1, ar2) {\n    if (ar1.createdAt < ar2.createdAt) return 1;\n    if (ar1.createdAt > ar2.createdAt) return -1;\n    return 0;\n  }\n  reviews.sort(compare);\n\n  const ul = document.getElementById('reviews-list');\n  reviews.forEach(review => {\n    ul.appendChild(createReviewHTML(review));\n  });\n\n  container.appendChild(ul);\n};\nfillErrorReviewsHTML = () => {\n  const container = document.getElementById('reviews-container');\n  const title = document.createElement('h3');\n  title.innerHTML = 'Reviews';\n  title.setAttribute('id', 'reviews-title');\n  container.appendChild(title);\n  const noReviews = document.createElement('p');\n  // const emptyList = document.getElementById('reviews-list');\n  // container.removeChild(emptyList);\n  noReviews.setAttribute('class', 'review--notfound');\n  noReviews.innerHTML =\n    'There are no older reviews to show: try again when online';\n  container.appendChild(noReviews);\n  return;\n};\n\n/**\n * Create review HTML and add it to the webpage.\n */\ncreateReviewHTML = review => {\n  const li = document.createElement('li');\n  const article = document.createElement('article');\n  article.setAttribute('tabindex', '0');\n  article.setAttribute('role', 'article');\n  article.setAttribute('arial-label', 'Review.');\n\n  const div = document.createElement('div');\n  const date = document.createElement('p');\n  //date.innerHTML = review.date;\n  date.innerHTML = new Date(review.createdAt).toDateString();\n  date.setAttribute('aria-label', `Date: ${review.date}.`);\n  date.setAttribute('class', 'review--date');\n  div.appendChild(date);\n\n  const name = document.createElement('p');\n  name.innerHTML = review.name;\n  name.setAttribute('class', 'review--author');\n  name.setAttribute('aria-label', `Author: ${review.name}.`);\n  div.appendChild(name);\n  div.setAttribute('class', 'review--head');\n  article.appendChild(div);\n\n  const rating = document.createElement('p');\n  let ratingString =\n    '<span class=\"review--ratingTitle\" arial-hidden=\"true\">Rating</span> <span class=\"review--ratingStars\" arial-hidden=\"true\">';\n  for (let i = 0, len = review.rating; i < len; i++) {\n    ratingString += '<span class=\"full\">&#9733;</span>';\n  }\n  if (review.rating < 5) {\n    for (let i = 0, len = 5 - review.rating; i < len; i++) {\n      ratingString += '<span class=\"empty\"></span>';\n    }\n  }\n  ratingString += '</span>';\n  rating.innerHTML = ratingString;\n  rating.setAttribute('aria-label', `Rating: ${review.rating} out of 5.`);\n  rating.setAttribute('class', 'review--rating');\n  article.appendChild(rating);\n\n  const comments = document.createElement('p');\n  comments.innerHTML = review.comments;\n  comments.setAttribute('class', 'review--comment');\n  article.appendChild(comments);\n\n  li.appendChild(article);\n\n  return li;\n};\n\n/**\n * Add restaurant name to the breadcrumb navigation menu\n */\nfillBreadcrumb = (restaurant = self.restaurant) => {\n  const breadcrumb = document\n    .getElementById('breadcrumb')\n    .getElementsByTagName('ol')[0];\n  const li = document.createElement('li');\n  const a = document.createElement('a');\n\n  a.innerHTML = restaurant.name;\n  a.setAttribute('aria-current', 'page');\n\n  li.appendChild(a);\n\n  breadcrumb.appendChild(li);\n};\n\n/**\n * Get a parameter by name from page URL.\n */\ngetParameterByName = (name, url) => {\n  if (!url) url = window.location.href;\n  name = name.replace(/[\\[\\]]/g, '\\\\$&');\n  const regex = new RegExp(`[?&]${name}(=([^&#]*)|&|#|$)`),\n    results = regex.exec(url);\n  if (!results) return null;\n  if (!results[2]) return '';\n  return decodeURIComponent(results[2].replace(/\\+/g, ' '));\n};\n\n/**\n * Escaping user input, from:\n * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions\n */\nescapeRegExp = string => {\n  //return string.replace(/[*+^${}()<>|[\\]\\\\]/g, '\\\\$&'); // $& means the whole matched string\n  return string.replace(/[*+^${}()<>|[\\]\\\\]/g, ' ');\n};\n\n/**\n * Verify and submit review\n */\nsubmitReview = event => {\n  let review,\n    reviewHtml,\n    form_button = document.getElementById('new-review--submit'),\n    form_name = document.getElementById('new-review--name'),\n    form_comment = document.getElementById('new-review--comment'),\n    form_rating = document.getElementById('new-review--rating'),\n    form_stars = form_rating.value,\n    form_messageArea = document.getElementById('new-review--msg'),\n    reviewList = document.getElementById('reviews-list'),\n    errorMessage = '';\n\n  const check_nameEmpty = '<li>Your name couldn&apos;t be empty</li>',\n    check_nameShort =\n      '<li>Your name is too short (please provide at least 3 characters)</li>',\n    check_commentEmpty = '<li>Your review couldn&apos;t be empty</li>',\n    check_commentShort =\n      '<li>Your review is too short <em>(at least 100 characters comment is requested)</em></li>',\n    check_noRating = '<li>Rating is not set</li>';\n\n  event.preventDefault();\n  resetMessage(form_messageArea);\n  form_button.disabled = true;\n  if (!form_name.value)\n    errorMessage += (errorMessage ? '<br/>' : '<ul>') + check_nameEmpty;\n\n  if (form_name.value.length < 2)\n    errorMessage += (errorMessage ? '<br/>' : '<ul>') + check_nameShort;\n\n  if (!form_comment.value)\n    errorMessage += (errorMessage ? '<br/>' : '<ul>') + check_commentEmpty;\n\n  if (form_comment.value.length < 100)\n    errorMessage += (errorMessage ? '<br/>' : '<ul>') + check_commentShort;\n\n  if (form_stars === 'none')\n    errorMessage += (errorMessage ? '<br/>' : '<ul>') + check_noRating;\n\n  if (errorMessage) {\n    errorMessage += '</ul>';\n    form_messageArea.innerHTML = errorMessage;\n    form_messageArea.setAttribute('class', 'error');\n    form_messageArea.style.display = 'block';\n    form_button.disabled = false;\n  } else {\n    // Assing values to review object\n    review = {\n      restaurant_id: self.restaurant.id,\n      name: escapeRegExp(form_name.value),\n      rating: parseInt(form_stars),\n      comments: escapeRegExp(form_comment.value)\n    };\n    // add review to local and remote db\n    DBHelper.saveReview(review).then(review => {\n      // create new review DOM node\n      reviewHtml = createReviewHTML(review);\n      // clean fields in form\n      form_name.value = '';\n      form_comment.value = '';\n      form_rating.selectedIndex = 0;\n      // success message\n      setTimeout(_ => {\n        reviewHtml.setAttribute('class', 'added');\n        if (reviewList.firstChild) {\n          reviewList.insertBefore(reviewHtml, reviewList.firstChild);\n        } else {\n          reviewList.appendChild(reviewHtml);\n        }\n        form_messageArea.setAttribute('class', 'success');\n        form_messageArea.innerHTML =\n          '<p>Thank you for sending your review!</p>';\n        form_messageArea.style.display = 'block';\n        form_button.disabled = false;\n        smoothScrollTo('reviews-container', 650, 100);\n        reviewHtml.firstChild.focus();\n      }, 250);\n      setTimeout(_ => {\n        resetMessage(form_messageArea);\n        reviewHtml.setAttribute('class', '');\n        form_button.disabled = false;\n      }, 7500);\n    });\n  }\n};\n\n/**\n * reset form message area\n */\nresetMessage = message => {\n  message.style.display = 'none';\n  message.classList.remove('success', 'error');\n  message.innerHTML = '';\n};\n\n/**\n * Easing function\n */\neaseInOutQuart = (time, from, distance, duration) => {\n  if ((time /= duration / 2) < 1)\n    return (distance / 2) * time * time * time * time + from;\n  return (-distance / 2) * ((time -= 2) * time * time * time - 2) + from;\n};\n/**\n * smooth scroll animation\n * remix version of iwazaru's gist\n * @orginal: https://gist.github.com/iwazaru/4c8819420ce5237aeaf338339df25c32\n * @param {int} endX: destination x coordinate\n * @param {int} duration: animation duration in ms\n */\nwindow.smoothScrollTo = (targetID, duration = 400, delta = 0) => {\n  let startY = window.scrollY || window.pageYOffset,\n    element = document.getElementById(targetID),\n    endY = element.offsetTop - element.scrollTop + element.clientTop - delta;\n  (distanceY = endY - startY), (startTime = new Date().getTime());\n  let timer = window.setInterval(function() {\n    let time = new Date().getTime() - startTime,\n      newY = easeInOutQuart(time, startY, distanceY, duration);\n    if (time >= duration) {\n      window.clearInterval(timer);\n    }\n    window.scrollTo(0, newY);\n  }, 1000 / 60); // 60 fps\n};\n"]}